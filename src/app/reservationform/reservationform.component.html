<app-navbar></app-navbar>
<div class="container">
    <div class="row">
<div class="col-6">
    <p-dropdown placeholder="liste des salles" [options]="rooms" (onChange)="choixSalle($event)" id="room" [(ngModel)]="Room"></p-dropdown>
</div>
<div class="col-6">
    <p-calendar [minDate]="minimumDate" [disabledDates]="invalidDates" [(ngModel)]="Date" id="date" placeholder="Date de reservation" (onSelect)="choixDate($event)" *ngIf="Room" dateFormat="dd.mm.yy"></p-calendar>
</div>
<div class="col-6">
<p-table #dt *ngIf="Date" [columns]="cols" [value]="TableData" [paginator]="true" [rows]="20">
    <ng-template pTemplate="caption">
        Reservation
    </ng-template>
    <ng-template pTemplate="header" let-columns>
            <tr>
                <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                    {{col.header}}
                </th>
            </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-i="rowIndex" let-columns="columns">
        <tr [pSelectableRow]="rowData">
            <td>{{rowData.date | date: 'dd/MM/yyyy'}}</td>
            <td>{{rowData.salle}}</td>
            <td>{{rowData.Horaire}}</td>
            <td>{{rowData.joueursMax}}</td>
            <td>{{rowData.VR}}</td>
            <td><button type="button3" pButton label="Reserver" style="background-color:#00567c;" (click)="reservation(i)"></button></td>
        </tr>
    </ng-template>
  </p-table>
  </div>
  <p-dialog [style]="{width: '500px', minWidth: '400px'}" *ngIf="RowTableData" header="Formulaire de réservation" [(visible)]="displayform" [responsive]="true" showEffect="fade" [modal]="true"  [style]="{width: '20%'}">
    <form>
        <div class="form-row">
            <div class="form-group col-md-6">
              <p-calendar [minDate]="minimumDate" [(ngModel)]="Date" name="calendar" [disabledDates]="invalidDates" placeholder="Date de reservation"></p-calendar>
            </div>
            <div class="form-group col-md-6">
              <select class="form-control"  name="selectcreneaux" [(ngModel)]="RowTableData.Horaire">
                <option selected="{{RowTableData.Horaire}}">{{RowTableData.Horaire}}</option>
                  <option *ngFor="let item of hourlist">{{item.value}}</option>
                </select>
            </div>
          </div>
        <div class="form-row">
          <div class="form-group col-md-4">
            <label for="inputNom">Nom</label>
            <input type="text" class="form-control" name="inputNom" [(ngModel)]="reservateur.Nom" placeholder="Nom">
          </div>
          <div class="form-group col-md-4">
            <label for="inputPrenom">Prénom</label>
            <input type="text" class="form-control" name="inputPrenom" [(ngModel)]="reservateur.Prenom" placeholder="Prénom">
          </div>
          <div class="form-group col-md-4">
              <label for="inputPrenom">Prénom</label>
              <p-dropdown [options]="civility" [(ngModel)]="reservateur.Civilite" name="Civilite"></p-dropdown>
            </div>
          
        </div>
        <div class="form-group">
          <label for="inputEmail">E-Mail</label>
          <input type="email" class="form-control" name="inputEmail" [(ngModel)]="reservateur.Email" placeholder="blabla@chocolat.com">
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="inputSalle">Salle</label>
            <select class="form-control" (change)="onchangeroom($event.target.value)" [(ngModel)]="RowTableData.salle" name="selectedsalle">
              <option selected="{{RowTableData.salle}}">{{RowTableData.salle}}</option>
                <option *ngFor="let item of rooms">{{item.value.name}}</option>
              </select>
          </div>
          <div class="form-group col-md-4">
            <label for="inputPlayers">Nb Joueur</label>
            <select class="form-control"  name="selectplayers" [(ngModel)]="JoueurMax" >
              <option *ngFor="let item of arrayPlayer(JoueurMax)">{{item}}</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="inputAge">Age</label>
            <input type="number" min="18" max="110" class="form-control" name="inputAge" [(ngModel)]="reservateur.Age" id="inputAge">
          </div>


          <div class="ui-grid-col-1" style="padding: 5px;">
              <button pButton type="button" icon="pi pi-plus"
                  (click)="onAddUsers()"></button>
          </div>
          
          <div class="ui-grid-col-12">
              <p-table [value]="users">
                  <ng-template pTemplate="body" let-user let-ri="rowIndex">
                      <tr>
                          <td pEditableColumn>
                              <p-cellEditor>
                                  <ng-template pTemplate="input">
                                      <input pInputText type="text" placeholder="nom" name="nom"
                                      [(ngModel)]="user.nom">
                                  </ng-template>
                                  <ng-template pTemplate="output">
                                      {{user.nom}}
                                  </ng-template>
                              </p-cellEditor>
                          </td>
                          <td pEditableColumn>
                              <p-cellEditor>
                                  <ng-template pTemplate="input">
                                      <input pInputText type="text" placeholder="prenom" name="prenom"
                                          [(ngModel)]="user.prenom">
                                  </ng-template>
                                  <ng-template pTemplate="output">
                                      {{user.prenom}}
                                  </ng-template>
                              </p-cellEditor>
                          </td>
                          <td pEditableColumn>
                              <p-cellEditor>
                                  <ng-template pTemplate="input">
                                      <p-dropdown [options]="civility" [(ngModel)]="user.civility" name="civility"></p-dropdown>
                                  </ng-template>
                                  <ng-template pTemplate="output">
                                      {{user.civility}}
                                  </ng-template>
                              </p-cellEditor>
                          </td>
                          <td pEditableColumn>
                              <p-cellEditor>
                                  <ng-template pTemplate="input">
                                      <input pInputText type="text" min="18" placeholder="age" name="age"
                                          [(ngModel)]="user.age">
                                  </ng-template>
                                  <ng-template pTemplate="output">
                                      {{user.age}}
                                  </ng-template>
                              </p-cellEditor>
                          </td>
                          <td pEditableColumn>
                              <p-cellEditor>
                                  <ng-template pTemplate="input">
                                      <p-dropdown [options]="allPrice.label" [(ngModel)]="user.tarif" name="tarif"></p-dropdown>
                                  </ng-template>
                                  <ng-template pTemplate="output">
                                      {{user.tarif}}
                                  </ng-template>
                              </p-cellEditor>
                          </td>
                          <!--<td style="text-align: center">
                              <i  icon="pi pi-plus" style="cursor: pointer; font-size: 18px;"
                                  (click)="onDeleteUser(user, ri)"></i>
                          </td>-->
                      </tr>
                  </ng-template>
              </p-table>
          </div>



         <!-- <div *ngFor="let item of arrayPlayer(JoueurMax)" >
            <div class="form-group col-md-6">
              <label>Participant n°{{item - 1}}</label>
            <div class="form-group col-md-2" ><input type="text" placeholder="Prénom" name="Prenom#" [(ngModel)]="arrayPrenom[item]" ></div>
            <div class="form-group col-md-3"><input type="text" placeholder="Nom" name="Nom#" [ngModel]="arrayNom[item]"></div>
          </div>
          </div>-->
        </div>
        <button type="submit" class="btn" (click)="close()" style="background-color: red;">Annuler</button>
        <button type="submit" class="btn btn-primary" (click)="save()">Valider</button>   
      </form>
</p-dialog>
</div>